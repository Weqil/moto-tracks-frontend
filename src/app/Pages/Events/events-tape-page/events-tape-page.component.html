<ion-content>

  <app-header (click)="openRegionModal()" [hiddenBackButton]="true" [headerTitle]="regionFilterName" icon='/assets/icons/arrow-down.svg'></app-header>

  <div class="tabs-container">
    <app-tabs>
      <app-tabs-item name="Текущие">
        <div *ngFor="let group of formatedEvents" class="events-grid">
          <span class="month">{{group.groupMonth}}</span>
          <div  *ngFor="let event of group.events; let i = index">
            <app-event-card [event]="event" >
              <div *ngIf="userService.userHaveRoot() && event.commissions_exists" class="button-container">
                <app-standart-button style="width: 100%;" (click)="generateGoogleLink(event.id)" buttonText="Выгрузить список"></app-standart-button>
                <app-standart-button style="width: 100%;" (click)="openUploadResultMpdal()" buttonText="Добавить результаты"></app-standart-button>
                <!-- <app-standart-button style="width: 100%;" (click)="redirectInConfirm(event.id)" buttonText="Модерация участников"></app-standart-button> -->
              </div>
            </app-event-card>
          </div>
        </div>
      </app-tabs-item>      
      
      <app-tabs-item name="Прошедшие">
        <div *ngFor="let group of formatedExpiredEvents" class="events-grid">
          <span class="month">{{group.groupMonth}}</span>
            <div  *ngFor="let event of group.events; let i = index">
              <app-event-card [event]="event">
                <div *ngIf="userService.userHaveRoot()" class="button-container">
                  <app-standart-button style="width: 100%;" (click)="generateGoogleLink(event.id)" buttonText="Выгрузить список"></app-standart-button>
                  <app-standart-button style="width: 100%;" (click)="openUploadResultMpdal()" buttonText="Добавить результаты"></app-standart-button>
                </div>
              </app-event-card>
            </div>
          </div>
        </app-tabs-item>
      </app-tabs>
  </div>
    
</ion-content>

<ion-modal [isOpen]="tableModalValue">
  <ng-template>
    <ion-content>
      <div class="google-tabs">
        <div class="google-tabs__modal-text">
            Список участников был отправлен на вашу почту {{userService.user.value?.email}}
            Сейчас можно открыть его по
          <a class="google-tabs__modal-text__link" target="_blank" [href]="googleTabsLink">этой ссылке</a>
        </div>
        <app-standart-button (click)="closetTableModal()" style="width: 100%;" buttonText="Закрыть" theme="light"></app-standart-button>
      </div>
    </ion-content>
  </ng-template>
  
</ion-modal>
  
<ion-modal class="upload-result-modal" (didDismiss)="closeUploadResultModalState()" [isOpen]="uploadResultModalState">
  <ng-template>
    <ion-content>
      <app-header headerTitle="Добавить результаты гонки" [customBack]="true" (customBackClick)="closeUploadResultModalState()">
      </app-header>
        <div class="main-container--with-header">
            <article class="add-result">
              <div class="upload">
                <div  
                (dragover)="onDragOver($event)"
                (dragleave)="onDragLeave($event)"
                (drop)="onDrop($event)"
                class="upload-wrapper">
                <div  [ngClass]="{ 'files-result-upload__active': isDragOver }" class="files-result-upload">
                  <div class="files-result-upload__wrapper">
                    <img class="upload-image" src="/assets/icons/images.svg" alt="">
                    <div class="upload-text">Перетащите сюда файлы для загрузки</div>
                    <input  accept=".jpg,.jpeg,.png,.gif,.bmp,.webp,.pdf,.doc,.docx," #fileInput class="file" multiple (change)="getResultFile($event)" type="file">
                  </div>
              
                </div>
              </div>
              <div class="files-grid">
                <ng-container *ngFor="let fileElement of resultsFilesUpload">
                  <div class="files-grid__item-wrapper">
                    <div class="files-grid__item">
                      <img src="/assets/icons/documents.svg" alt="">
                      {{fileElement.file.name}}
                    </div>
                    <app-circle-button (click)="deleteUploudResultFile(fileElement)" icon="/assets/icons/trash.svg"></app-circle-button>
                  </div>
          
                </ng-container>
             
              </div>
            
              
              <app-standart-button style="width: 100%;" buttonText="Сохранить"></app-standart-button>
            </div>
            </article>
         
        
        
        </div>
    </ion-content>
  </ng-template>
</ion-modal>

<ion-modal class="region-modal" (didDismiss)="closeRegionModal()"  [isOpen]="regionModalState">
  <ng-template>
    <ion-content>
      <div class="region-modal-container">
        <app-standart-input-search 
          label="Область/край*" 
          [searchCurrentItems]="searchRegionItems" 
          [searchItems]="searchRegionItems" 
          (changeSearchValue)="filterEventsInLocation($event)">
          </app-standart-input-search>
      </div>
    </ion-content>
  </ng-template>  
</ion-modal>       
import{a as R}from"./chunk-L3WJPVL4.js";import{a as j}from"./chunk-J3CYG6CI.js";import{a as N}from"./chunk-EE2EJ3U4.js";import{a as T}from"./chunk-J42XBVPU.js";import{c as M,f as O}from"./chunk-LB5WRDFC.js";import{a as L}from"./chunk-E7XUYOOL.js";import{a as U}from"./chunk-KY3FK4A4.js";import{a as c}from"./chunk-QFO5OYTV.js";import{a as f}from"./chunk-GF6VGRIS.js";import{A as S,B as b,C as h,D as A,M as P,ba as k,j as B,r as D,x as l,z as y}from"./chunk-FYK4VEB7.js";import{Cb as p,D as I,Ha as d,P as F,Qa as w,V as r,bb as g,h as _,ib as a,jb as s,kb as v,rb as m,y as C}from"./chunk-LFIOHD3L.js";import"./chunk-UKLEBRLV.js";import"./chunk-5E46SPE4.js";import"./chunk-ACGYCHS3.js";import"./chunk-ZXFZWMZA.js";import"./chunk-F7XBNY6P.js";import"./chunk-IEY6ZC2G.js";import"./chunk-MNDBORQJ.js";import"./chunk-7QVI4S4L.js";import"./chunk-4U6PRYVA.js";import"./chunk-XODSA4YU.js";import"./chunk-JWIEPCRG.js";import"./chunk-QPVVTFFW.js";import"./chunk-J6ICYO4L.js";import"./chunk-LF5XB4YN.js";import"./chunk-LNJ3S2LQ.js";var x=(()=>{let n=class n{constructor(){this.http=r(B),this.userService=r(c)}loginUser(o){return this.http.post(`${f.BACKEND_URL}:${f.BACKEND_PORT}/api/login`,o)}};n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=F({token:n,factory:n.\u0275fac,providedIn:"root"});let t=n;return t})();var E=function(t){return t.default="\u041E\u0448\u0438\u0431\u043A\u0430, \u043F\u043E\u043F\u0440\u043E\u0431\u0443\u0439\u0442\u0435 \u043F\u043E\u0437\u0436\u0435",t.vkGroupSearch="\u041C\u044B \u043D\u0435 \u043D\u0430\u0448\u043B\u0438 \u0433\u0440\u0443\u043F\u043F\u044B \u0432 \u043A\u043E\u0442\u043E\u0440\u044B\u0445 \u0432\u044B \u044F\u0432\u043B\u044F\u0435\u0442\u0435\u0441\u044C \u0410\u0434\u043C\u0438\u043D\u0438\u0441\u0442\u0440\u0430\u0442\u043E\u0440\u043E\u043C, \u041C\u043E\u0434\u0435\u0440\u0430\u0442\u043E\u0440\u043E\u043C \u0438\u043B\u0438 \u0420\u0435\u0434\u0430\u043A\u0442\u043E\u0440\u043E\u043C, \u043D\u0435\u043A\u043E\u0442\u043E\u0440\u044B\u0435 \u0448\u0430\u0433\u0438 \u0441\u043A\u0440\u044B\u0442\u044B",t.vkTokenError="\u041D\u0430 \u0441\u0442\u043E\u0440\u043E\u043D\u0435 \u0412\u043A\u043E\u043D\u0442\u0430\u043A\u0442\u0435 \u0432\u043E\u0437\u043D\u0438\u043A\u043B\u0438 \u043F\u0440\u043E\u0431\u043B\u0435\u043C\u044B, \u043F\u043E\u0436\u0430\u043B\u0443\u0439\u0441\u0442\u0430 \u0430\u0432\u0442\u043E\u0440\u0438\u0437\u0443\u0439\u0442\u0435\u0441\u044C \u0437\u0430\u043D\u043E\u0432\u043E",t.vkLikesError="\u041D\u0435 \u0443\u0434\u0430\u043B\u043E\u0441\u044C \u043E\u0431\u043D\u043E\u0432\u0438\u0442\u044C \u043B\u0430\u0439\u043A\u0438",t.CommentsNoValue="\u041A\u043E\u043C\u043C\u0435\u043D\u0442\u0430\u0440\u0438\u0439 \u043F\u0443\u0441\u0442",t.CommentError="\u041A\u043E\u043C\u043C\u0435\u043D\u0442\u0430\u0440\u0438\u0439 \u043D\u0435 \u043E\u043F\u0443\u0431\u043B\u0438\u043A\u043E\u0432\u0430\u043D",t.LocationSearchError="\u043D\u0435 \u0441\u043E\u0433\u043B\u0438 \u043D\u0430\u0439\u0442\u0438 \u0433\u043E\u0440\u043E\u0434, \u043F\u043E\u043F\u0440\u043E\u0431\u0443\u0439\u0442\u0435 \u0435\u0449\u0451...",t.emailNotCorrect="\u0417\u043D\u0430\u0447\u0435\u043D\u0438\u0435 \u043F\u043E\u043B\u044F \u0438\u043C\u044F \u0434\u043E\u043B\u0436\u043D\u043E \u0431\u044B\u0442\u044C \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0442\u0435\u043B\u044C\u043D\u044B\u043C \u044D\u043B\u0435\u043A\u0442\u0440\u043E\u043D\u043D\u044B\u043C \u0430\u0434\u0440\u0435\u0441\u043E\u043C.",t}(E||{});var c4=(()=>{let n=class n{constructor(){this.loading=r(j),this.loginService=r(x),this.userService=r(c),this.router=r(D),this.navController=r(P),this.authService=r(U),this.loginInvalid={localError:!1,serverError:!1,name:{status:!1,message:""},password:{status:!1,message:""}}}validateForm(){var o,e,u,i;this.loginInvalid.localError=!1,(o=this.loginForm.get("name"))!=null&&o.errors?(this.loginInvalid.localError=!0,this.loginInvalid.name.status=!0,this.loginInvalid.name.message=(e=this.loginForm.get("name"))!=null&&e.hasError("required")?"\u041F\u043E\u043B\u0435 \u043D\u0435 \u043C\u043E\u0436\u0435\u0442 \u0431\u044B\u0442\u044C \u043F\u0443\u0441\u0442\u044B\u043C":"E-mail \u0434\u043E\u043B\u0436\u0435\u043D \u0431\u044B\u0442\u044C \u043D\u0435 \u043C\u0435\u043D\u0435\u0435 3 \u0441\u0438\u043C\u0432\u043E\u043B\u043E\u0432"):(this.loginInvalid.name.status=!1,this.loginInvalid.name.message=""),(u=this.loginForm.get("password"))!=null&&u.errors?(this.loginInvalid.localError=!0,this.loginInvalid.password.status=!0,this.loginInvalid.password.message=(i=this.loginForm.get("password"))!=null&&i.hasError("required")?"\u041F\u043E\u043B\u0435 \u043D\u0435 \u043C\u043E\u0436\u0435\u0442 \u0431\u044B\u0442\u044C \u043F\u0443\u0441\u0442\u044B\u043C":"\u041F\u0430\u0440\u043E\u043B\u044C \u0434\u043E\u043B\u0436\u0435\u043D \u0431\u044B\u0442\u044C \u043D\u0435 \u043C\u0435\u043D\u0435\u0435 8 \u0441\u0438\u043C\u0432\u043E\u043B\u043E\u0432"):(this.loginInvalid.password.status=!1,this.loginInvalid.password.message="")}errorResponseAfterLogin(o){let e=o.error.message;this.loginInvalid.serverError=!0,e===E.emailNotCorrect&&(this.loginInvalid.name.status=!0,this.loginInvalid.name.message="\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043A\u043E\u0440\u0440\u0435\u043A\u0442\u043D\u044B\u0439 E-mail"),(e==="\u0417\u043D\u0430\u0447\u0435\u043D\u0438\u0435 \u043F\u043E\u043B\u044F \u0438\u043C\u044F \u043D\u0435 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u0435\u0442."||o.status=="403")&&(this.loginInvalid.name.status=!0,this.loginInvalid.password.status=!0,this.loginInvalid.password.message="\u041F\u043E\u0447\u0442\u0430 \u0438\u043B\u0438 \u043F\u0430\u0440\u043E\u043B\u044C \u043D\u0435 \u0432\u0435\u0440\u043D\u044B\u0439"),(o.status="422")&&(this.loginInvalid.name.status=!0,this.loginInvalid.password.status=!0,this.loginInvalid.password.message="\u0422\u0430\u043A\u043E\u0433\u043E \u0430\u043A\u043A\u0430\u0443\u043D\u0442\u0430 \u043D\u0435 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u0435\u0442"),this.loginForm.enable()}clearErrors(){(this.loginInvalid.localError||this.loginInvalid.serverError)&&this.validateForm()}submitLoginForm(){var o,e;if(this.validateForm(),!this.loginInvalid.localError){let u=new FormData;u.append("email",(o=this.loginForm.get("name"))==null?void 0:o.value),u.append("password",(e=this.loginForm.get("password"))==null?void 0:e.value),this.loading.showLoading(),this.loginService.loginUser(u).pipe(C(i=>(console.log(i),this.errorResponseAfterLogin(i),this.errorText=i,_)),I(()=>{this.loading.hideLoading()})).subscribe(i=>{this.userService.setUserInLocalStorage(i.user),this.authService.setAuthToken(String(i.access_token)),this.router.navigate(["/cabinet"])})}}redirectInRegistration(){this.navController.navigateForward("/registration",{animationDirection:"forward"})}ngOnInit(){this.loginForm=new S({name:new h("",[l.required,l.minLength(3),l.maxLength(50)]),password:new h("",[l.required,l.minLength(3)])})}};n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=w({type:n,selectors:[["app-login-page"]],decls:19,vars:10,consts:[["headerTitle","\u0412\u0445\u043E\u0434"],[1,"main-container--with-header"],[1,"login"],[1,"login__logo"],["src","/assets/icons/favicon.png","alt","",1,"login__logo__img"],["action","",1,"login__form"],["name","email",3,"changeInput","invalid","errorMessage","label","control"],["type","password","password","email",3,"changeInput","invalid","errorMessage","openPassword","label","control"],[1,"recovery-password-wrapper"],[1,"recovery-password"],[1,"submit-button"],["buttonText","\u0412\u043E\u0439\u0442\u0438","type","submit",3,"onClick","disabled"],[1,"dont-have-account"],[1,"dont-have-account__registration-link",3,"click"],[1,"dont-have-account__registration-link__route"]],template:function(e,u){e&1&&(a(0,"ion-content"),v(1,"app-header",0),a(2,"div",1)(3,"div",2)(4,"div",3),v(5,"img",4),s(),a(6,"form",5)(7,"app-standart-input",6),m("changeInput",function(){return u.clearErrors()}),s(),a(8,"app-standart-input",7),m("changeInput",function(){return u.clearErrors()}),s(),a(9,"div",8)(10,"span",9),p(11,"\u0417\u0430\u0431\u044B\u043B(\u0430) \u043F\u0430\u0440\u043E\u043B\u044C"),s()()()(),a(12,"div",10)(13,"app-standart-button",11),m("onClick",function(){return u.submitLoginForm()}),s()(),a(14,"div",12)(15,"span",13),m("click",function(){return u.redirectInRegistration()}),p(16,"\u041D\u0435\u0442 \u0430\u043A\u043A\u0430\u0443\u043D\u0442\u0430? "),a(17,"span",14),p(18,"\u0421\u043E\u0437\u0434\u0430\u0442\u044C \u0430\u043A\u043A\u0430\u0443\u043D\u0442"),s()()()()()),e&2&&(d(7),g("invalid",u.loginInvalid.name.status)("errorMessage",u.loginInvalid.name.message)("label","E-mail")("control",u.loginForm.get("name")),d(),g("invalid",u.loginInvalid.password.status)("errorMessage",u.loginInvalid.password.message)("openPassword",!0)("label","\u041F\u0430\u0440\u043E\u043B\u044C")("control",u.loginForm.get("password")),d(5),g("disabled",u.loginForm.invalid))},dependencies:[L,k,A,y,b,N,T,R,O,M],styles:[".login__logo[_ngcontent-%COMP%]{display:flex;justify-content:center}.login__logo[_ngcontent-%COMP%]   .login__logo__img[_ngcontent-%COMP%]{width:7rem}.login__form[_ngcontent-%COMP%]{display:flex;padding:0 1rem;flex-direction:column;gap:var(--standart-padding)}.recovery-password-wrapper[_ngcontent-%COMP%]{display:flex;justify-content:flex-end}.recovery-password[_ngcontent-%COMP%]{font-family:var(--font-regular);font-size:var(--font-little-size);color:var(--grey-color);opacity:55%}.submit-button[_ngcontent-%COMP%]{padding-top:var(--standart-padding)}.dont-have-account[_ngcontent-%COMP%]{padding-top:2rem;display:flex;align-items:center;justify-content:center}.dont-have-account[_ngcontent-%COMP%]   .dont-have-account__registration-link[_ngcontent-%COMP%]{font-size:.75rem;font-family:var(--font-regular);color:var(--gray-color);cursor:pointer}.dont-have-account[_ngcontent-%COMP%]   .dont-have-account__registration-link__route[_ngcontent-%COMP%]{font-size:.75rem;font-family:var(--font-regular);color:var(--blue-primary-color);cursor:pointer}"]});let t=n;return t})();export{c4 as LoginPageComponent};

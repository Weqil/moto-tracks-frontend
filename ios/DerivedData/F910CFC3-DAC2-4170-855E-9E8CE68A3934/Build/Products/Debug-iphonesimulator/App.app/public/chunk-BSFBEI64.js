import{a as W,i as X}from"./chunk-FYK4VEB7.js";import{$ as k,B as T,Ia as y,J as m,K as z,L,P as w,Q as V,Qa as Q,Ra as G,S as R,Sa as q,U as c,c as p,f as M,g as d,ga as O,ha as u,j as v,k as D,kb as U,l as Z,m as P,o as b,oa as B,q as F,u as E,v as S,w as N,x as A,xb as K,yb as H,zb as J}from"./chunk-LFIOHD3L.js";import{a as l,b as x,d as I}from"./chunk-LNJ3S2LQ.js";var te=["container"];var f=class{constructor(a){this.ngZone=a,this.pending=[],this.listeners=[],this.targetStream=new d(void 0)}getLazyEmitter(a){return this.targetStream.pipe(m(h=>{let t=new p(e=>{if(!h){this.pending.push({observable:t,observer:e});return}let n=r=>{let o={event:r,target:h,ymaps};this.ngZone.run(()=>e.next(o))},s=h.events.add(a,n);return this.listeners.push({name:a,callback:n,manager:s}),()=>s.remove(a,n)});return t}))}setTarget(a){let h=this.targetStream.value;a!==h&&(h&&(this.clearListeners(),this.pending=[]),this.targetStream.next(a),this.pending.forEach(t=>t.observable.subscribe(t.observer)),this.pending=[])}destroy(){this.clearListeners(),this.pending=[],this.targetStream.complete()}clearListeners(){this.listeners.forEach(a=>{let{name:h,callback:t,manager:e}=a;e.remove(h,t)}),this.listeners=[]}},Y=new R("YA_CONFIG",{factory:()=>({})});function ae(i){return a=>new p(h=>a.subscribe({next:t=>i.run(()=>h.next(t)),error:t=>i.run(()=>h.error(t)),complete:()=>i.run(()=>h.complete())}))}function j(i){return a=>new p(h=>i.runOutsideAngular(()=>a.subscribe(h)))}var _=(()=>{let a=class a{constructor(t,e,n,s){this.document=e,this.ngZone=s,this.defaultConfig={lang:"ru_RU",version:"2.1"},this.config$=new d(this.defaultConfig),this.cache=new Map,this.isBrowser=X(n),P(t)||(t=D(t)),t.subscribe(r=>{this.config$.next(l(l({},this.defaultConfig),r))})}load(){return this.isBrowser?this.config$.pipe(j(this.ngZone),F(t=>{let e=this.getScriptSource(t),n=this.cache.get(e)||{};if(n.ymaps){let g=n.ymaps;return v(g.ready()).pipe(j(this.ngZone),L(()=>window.ymaps=g),b(()=>g))}let s=n.script;s||(s=this.createScript(t),this.cache.set(e,{script:s}),this.document.body.appendChild(s)),window.ymaps&&delete window.ymaps;let r=E(s,"load").pipe(m(()=>v(ymaps.ready())),L(()=>this.cache.set(e,{script:s,ymaps})),b(()=>ymaps)),o=E(s,"error").pipe(m(Z));return S(r,o).pipe(j(this.ngZone),T(1))})):N}createScript(t){let e=this.document.createElement("script");return e.type="text/javascript",e.src=this.getScriptSource(t),e.id="yandexMapsApiScript",e.async=!0,e.defer=!0,e}getScriptSource(t){let o=t,{enterprise:e,version:n}=o,s=I(o,["enterprise","version"]),r=this.convertConfigIntoQueryParams(s);if(n==="v3")throw new Error("This package does not support the Yandex.Maps API v3. See https://www.npmjs.com/package/angular-yandex-maps-v3");return`https://${e?"enterprise.":""}api-maps.yandex.ru/${n}/?${r}`}convertConfigIntoQueryParams(t){return Object.entries(t).map(([e,n])=>`${e}=${n}`).join("&")}};a.\u0275fac=function(e){return new(e||a)(c(Y),c(W),c(B),c(u))},a.\u0275prov=w({token:a,factory:a.\u0275fac,providedIn:"root"});let i=a;return i})(),ne=()=>`f${Date.now().toString(16)}`,ie=(()=>{let a=class a{constructor(t,e){this.ngZone=t,this.yaApiLoaderService=e,this.destroy$=new M,this.eventManager=new f(this.ngZone),this.map$=new d(null),this.center=[0,0],this.zoom=10,this.ready=new O,this.actionbegin=this.eventManager.getLazyEmitter("actionbegin"),this.actionbreak=this.eventManager.getLazyEmitter("actionbreak"),this.actionend=this.eventManager.getLazyEmitter("actionend"),this.actiontick=this.eventManager.getLazyEmitter("actiontick"),this.actiontickcomplete=this.eventManager.getLazyEmitter("actiontickcomplete"),this.balloonclose=this.eventManager.getLazyEmitter("balloonclose"),this.balloonopen=this.eventManager.getLazyEmitter("balloonopen"),this.boundschange=this.eventManager.getLazyEmitter("boundschange"),this.yaclick=this.eventManager.getLazyEmitter("click"),this.yacontextmenu=this.eventManager.getLazyEmitter("contextmenu"),this.yadblclick=this.eventManager.getLazyEmitter("dblclick"),this.destroy=this.eventManager.getLazyEmitter("destroy"),this.hintclose=this.eventManager.getLazyEmitter("hintclose"),this.hintopen=this.eventManager.getLazyEmitter("hintopen"),this.marginchange=this.eventManager.getLazyEmitter("marginchange"),this.yamousedown=this.eventManager.getLazyEmitter("mousedown"),this.yamouseenter=this.eventManager.getLazyEmitter("mouseenter"),this.yamouseleave=this.eventManager.getLazyEmitter("mouseleave"),this.yamousemove=this.eventManager.getLazyEmitter("mousemove"),this.yamouseup=this.eventManager.getLazyEmitter("mouseup"),this.multitouchend=this.eventManager.getLazyEmitter("multitouchend"),this.multitouchmove=this.eventManager.getLazyEmitter("multitouchmove"),this.multitouchstart=this.eventManager.getLazyEmitter("multitouchstart"),this.optionschange=this.eventManager.getLazyEmitter("optionschange"),this.sizechange=this.eventManager.getLazyEmitter("sizechange"),this.typechange=this.eventManager.getLazyEmitter("typechange"),this.yawheel=this.eventManager.getLazyEmitter("wheel")}ngOnChanges(t){this.ngZone.runOutsideAngular(()=>{let e=this.map$.value;if(e){let{center:n,zoom:s,state:r,options:o}=t;r&&this.setState(this.combineState(),e),n&&e.setCenter(n.currentValue),s&&e.setZoom(s.currentValue),o&&e.options.set(o.currentValue)}})}ngAfterViewInit(){this.yaApiLoaderService.load().pipe(z(this.destroy$)).subscribe(()=>{let t=ne(),e=this.createMap(t);this.map$.value&&this.map$.value.destroy(),this.map$.next(e),this.eventManager.setTarget(e),this.ready.emit({ymaps,target:e})})}ngOnDestroy(){this.eventManager.destroy(),this.destroy$.next(),this.destroy$.complete()}setState(t,e){let{behaviors:n,bounds:s,center:r,controls:o,margin:g,type:C,zoom:$}=t;n&&e.behaviors.enable(n),s&&e.setBounds(s),r&&e.setCenter(r),o&&o.forEach(ee=>e.controls.add(ee)),g&&e.margin.setDefaultMargin(g),C&&e.setType(C),$&&e.setZoom($)}createMap(t){let e=this.container.nativeElement;return e.setAttribute("id",t),e.style.cssText="width: 100%; height: 100%;",new ymaps.Map(t,this.combineState(),this.options||{})}combineState(){var e,n;let t=this.state||{};return x(l({},t),{center:this.center||t.center||[0,0],zoom:(n=(e=this.zoom)!=null?e:t.zoom)!=null?n:10})}};a.\u0275fac=function(e){return new(e||a)(y(u),y(_))},a.\u0275cmp=Q({type:a,selectors:[["ya-map"]],viewQuery:function(e,n){if(e&1&&K(te,5),e&2){let s;H(s=J())&&(n.container=s.first)}},inputs:{center:"center",zoom:"zoom",state:"state",options:"options"},outputs:{ready:"ready",actionbegin:"actionbegin",actionbreak:"actionbreak",actionend:"actionend",actiontick:"actiontick",actiontickcomplete:"actiontickcomplete",balloonclose:"balloonclose",balloonopen:"balloonopen",boundschange:"boundschange",yaclick:"yaclick",yacontextmenu:"yacontextmenu",yadblclick:"yadblclick",destroy:"destroy",hintclose:"hintclose",hintopen:"hintopen",marginchange:"marginchange",yamousedown:"yamousedown",yamouseenter:"yamouseenter",yamouseleave:"yamouseleave",yamousemove:"yamousemove",yamouseup:"yamouseup",multitouchend:"multitouchend",multitouchmove:"multitouchmove",multitouchstart:"multitouchstart",optionschange:"optionschange",sizechange:"sizechange",typechange:"typechange",yawheel:"yawheel"},standalone:!1,features:[k],decls:2,vars:0,consts:[["container",""]],template:function(e,n){e&1&&U(0,"div",null,0)},encapsulation:2,changeDetection:0});let i=a;return i})();var we=(()=>{let a=class a{constructor(t,e){this.ngZone=t,this.yaMapComponent=e,this.destroy$=new M,this.eventManager=new f(this.ngZone),this.geometry=[],this.ready=new O,this.balloonclose=this.eventManager.getLazyEmitter("balloonclose"),this.balloonopen=this.eventManager.getLazyEmitter("balloonopen"),this.beforedrag=this.eventManager.getLazyEmitter("beforedrag"),this.beforedragstart=this.eventManager.getLazyEmitter("beforedragstart"),this.yaclick=this.eventManager.getLazyEmitter("click"),this.yacontextmenu=this.eventManager.getLazyEmitter("contextmenu"),this.yadblclick=this.eventManager.getLazyEmitter("dblclick"),this.yadrag=this.eventManager.getLazyEmitter("drag"),this.yadragend=this.eventManager.getLazyEmitter("dragend"),this.yadragstart=this.eventManager.getLazyEmitter("dragstart"),this.editorstatechange=this.eventManager.getLazyEmitter("editorstatechange"),this.geometrychange=this.eventManager.getLazyEmitter("geometrychange"),this.hintclose=this.eventManager.getLazyEmitter("hintclose"),this.hintopen=this.eventManager.getLazyEmitter("hintopen"),this.mapchange=this.eventManager.getLazyEmitter("mapchange"),this.yamousedown=this.eventManager.getLazyEmitter("mousedown"),this.yamouseenter=this.eventManager.getLazyEmitter("mouseenter"),this.yamouseleave=this.eventManager.getLazyEmitter("mouseleave"),this.yamousemove=this.eventManager.getLazyEmitter("mousemove"),this.yamouseup=this.eventManager.getLazyEmitter("mouseup"),this.multitouchend=this.eventManager.getLazyEmitter("multitouchend"),this.multitouchmove=this.eventManager.getLazyEmitter("multitouchmove"),this.multitouchstart=this.eventManager.getLazyEmitter("multitouchstart"),this.optionschange=this.eventManager.getLazyEmitter("optionschange"),this.overlaychange=this.eventManager.getLazyEmitter("overlaychange"),this.parentchange=this.eventManager.getLazyEmitter("parentchange"),this.propertieschange=this.eventManager.getLazyEmitter("propertieschange"),this.yawheel=this.eventManager.getLazyEmitter("wheel")}ngOnChanges(t){this.ngZone.runOutsideAngular(()=>{var n;let{placemark:e}=this;if(e){let{geometry:s,properties:r,options:o}=t;s&&((n=e.geometry)==null||n.setCoordinates(s.currentValue)),r&&e.properties.set(r.currentValue),o&&e.options.set(o.currentValue)}})}ngOnInit(){this.yaMapComponent.map$.pipe(A(Boolean),z(this.destroy$)).subscribe(t=>{let e=this.createPlacemark();this.placemark=e,t.geoObjects.add(e),this.eventManager.setTarget(e),this.ready.emit({ymaps,target:e})})}ngOnDestroy(){var t,e;this.placemark&&((e=(t=this.yaMapComponent)==null?void 0:t.map$.value)==null||e.geoObjects.remove(this.placemark),this.eventManager.destroy()),this.destroy$.next(),this.destroy$.complete()}createPlacemark(){return new ymaps.Placemark(this.geometry,this.properties,this.options)}};a.\u0275fac=function(e){return new(e||a)(y(u),y(ie))},a.\u0275dir=q({type:a,selectors:[["ya-placemark"]],inputs:{geometry:"geometry",properties:"properties",options:"options"},outputs:{ready:"ready",balloonclose:"balloonclose",balloonopen:"balloonopen",beforedrag:"beforedrag",beforedragstart:"beforedragstart",yaclick:"yaclick",yacontextmenu:"yacontextmenu",yadblclick:"yadblclick",yadrag:"yadrag",yadragend:"yadragend",yadragstart:"yadragstart",editorstatechange:"editorstatechange",geometrychange:"geometrychange",hintclose:"hintclose",hintopen:"hintopen",mapchange:"mapchange",yamousedown:"yamousedown",yamouseenter:"yamouseenter",yamouseleave:"yamouseleave",yamousemove:"yamousemove",yamouseup:"yamouseup",multitouchend:"multitouchend",multitouchmove:"multitouchmove",multitouchstart:"multitouchstart",optionschange:"optionschange",overlaychange:"overlaychange",parentchange:"parentchange",propertieschange:"propertieschange",yawheel:"yawheel"},standalone:!1,features:[k]});let i=a;return i})();var ke=(()=>{let a=class a{static forRoot(t){return{ngModule:a,providers:[{provide:Y,useValue:t}]}}};a.\u0275fac=function(e){return new(e||a)},a.\u0275mod=G({type:a}),a.\u0275inj=V({});let i=a;return i})(),Oe=(()=>{let a=class a{constructor(t,e){this.ngZone=t,this.yaApiLoaderService=e}geocode(t,e){return this.yaApiLoaderService.load().pipe(m(()=>v(ymaps.geocode(t,e))),ae(this.ngZone))}};a.\u0275fac=function(e){return new(e||a)(c(u),c(_))},a.\u0275prov=w({token:a,factory:a.\u0275fac,providedIn:"root"});let i=a;return i})();export{ie as a,we as b,ke as c,Oe as d};
